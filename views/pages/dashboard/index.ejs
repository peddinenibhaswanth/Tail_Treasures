<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<% if (currentUser.role === 'admin' || currentUser.role === 'co-admin') { %>
  
  
  <div class="container-fluid py-4">
    <div class="row mb-4">
      <div class="col">
        <h2 class="mb-0">Dashboard</h2>
        <p class="text-muted">Welcome to the <%= currentUser.role === 'admin' ? 'admin' : 'co-admin' %> dashboard</p>
      </div>
    </div>
    
    <% if (stats && typeof stats !== 'undefined') { %>
    <div class="row">
      <div class="col-md-3 mb-4">
        <div class="card bg-primary text-white h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-uppercase mb-0">Users</h6>
                <h2 class="mb-0"><%= stats.userCount %></h2>
              </div>
              <i class="fas fa-users fa-2x"></i>
            </div>
          </div>
          <div class="card-footer d-flex align-items-center justify-content-between">
            <a href="/admin/users" class="text-white text-decoration-none">View Details</a>
            <i class="fas fa-angle-right"></i>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 mb-4">
        <div class="card bg-success text-white h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-uppercase mb-0">Pets</h6>
                <h2 class="mb-0"><%= stats.petCount %></h2>
              </div>
              <i class="fas fa-paw fa-2x"></i>
            </div>
          </div>
          <div class="card-footer d-flex align-items-center justify-content-between">
            <a href="/admin/pets" class="text-white text-decoration-none">View Details</a>
            <i class="fas fa-angle-right"></i>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 mb-4">
        <div class="card bg-warning text-dark h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-uppercase mb-0">Products</h6>
                <h2 class="mb-0"><%= stats.productCount %></h2>
              </div>
              <i class="fas fa-box fa-2x"></i>
            </div>
          </div>
          <div class="card-footer d-flex align-items-center justify-content-between">
            <a href="/admin/products" class="text-white text-decoration-none">View Details</a>
            <i class="fas fa-angle-right"></i>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 mb-4">
        <div class="card bg-danger text-white h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-uppercase mb-0">Applications</h6>
                <h2 class="mb-0"><%= stats.applicationCount %></h2>
              </div>
              <i class="fas fa-file-alt fa-2x"></i>
            </div>
          </div>
          <div class="card-footer d-flex align-items-center justify-content-between">
            <a href="/admin/applications" class="text-white text-decoration-none">View Details</a>
            <i class="fas fa-angle-right"></i>
          </div>
        </div>
      </div>
    </div>
    <% } else { %>
      <p>No statistics available</p>
    <% } %>
    
    <div class="row">
      <div class="col-md-6 mb-4">
        <div class="card shadow-sm">
          <div class="card-header bg-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Recent Pets</h5>
              <a href="/admin/pets" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
          </div>
          <div class="card-body p-0">
            <% if (recentPets && recentPets.length > 0) { %>
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="bg-light">
                    <tr>
                      <th style="width: 60px;">Image</th>
                      <th>Name</th>
                      <th>Species</th>
                      <th>Status</th>
                      <th>Added</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% recentPets.forEach(pet => { %>
                      <tr>
                        <td>
                          <img src="<%= pet.mainImage || '/images/pet-placeholder.jpg' %>" alt="<%= pet.name %>" class="img-thumbnail" style="width: 50px; height: 50px; object-fit: cover;">
                        </td>
                        <td><a href="/pets/<%= pet._id %>" class="text-decoration-none"><%= pet.name %></a></td>
                        <td><span class="text-capitalize"><%= pet.species %></span></td>
                        <td>
                          <% if (pet.status === 'available') { %>
                            <span class="badge bg-success">Available</span>
                          <% } else if (pet.status === 'pending') { %>
                            <span class="badge bg-warning text-dark">Pending</span>
                          <% } else if (pet.status === 'adopted') { %>
                            <span class="badge bg-info">Adopted</span>
                          <% } %>
                        </td>
                        <td><%= new Date(pet.createdAt).toLocaleDateString() %></td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            <% } else { %>
              <p>No recent pets</p>
            <% } %>
          </div>
        </div>
      </div>
      
      <div class="col-md-6 mb-4">
        <div class="card shadow-sm">
          <div class="card-header bg-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Recent Applications</h5>
              <a href="/admin/applications" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
          </div>
          <div class="card-body p-0">
            <% if (recentApplications && recentApplications.length > 0) { %>
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="bg-light">
                    <tr>
                      <th>Pet</th>
                      <th>Applicant</th>
                      <th>Status</th>
                      <th>Submitted</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% recentApplications.forEach(application => { %>
                      <tr>
                        <td>
                          <% if (application.pet) { %>
                            <a href="/pets/<%= application.pet._id %>" class="text-decoration-none"><%= application.pet.name %></a>
                          <% } else { %>
                            Unknown Pet
                          <% } %>
                        </td>
                        <td>
                          <% if (application.adopter) { %>
                            <%= application.adopter.name %>
                          <% } else { %>
                            Unknown User
                          <% } %>
                        </td>
                        <td>
                          <% if (application.status === 'submitted') { %>
                            <span class="badge bg-primary">Submitted</span>
                          <% } else if (application.status === 'under review') { %>
                            <span class="badge bg-warning text-dark">Under Review</span>
                          <% } else if (application.status === 'approved') { %>
                            <span class="badge bg-success">Approved</span>
                          <% } else if (application.status === 'denied') { %>
                            <span class="badge bg-danger">Denied</span>
                          <% } %>
                        </td>
                        <td><%= new Date(application.createdAt).toLocaleDateString() %></td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            <% } else { %>
              <p>No recent applications</p>
            <% } %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-6 mb-4">
        <div class="card shadow-sm">
          <div class="card-header bg-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Pending Approvals</h5>
              <a href="/admin/users" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
          </div>
          <div class="card-body p-0">
            <% if (pendingUsers && pendingUsers.length > 0) { %>
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="bg-light">
                    <tr>
                      <th>Name</th>
                      <th>Email</th>
                      <th>Role</th>
                      <th>Registered</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% pendingUsers.forEach(user => { %>
                      <tr>
                        <td><%= user.name %></td>
                        <td><%= user.email %></td>
                        <td><span class="text-capitalize"><%= user.role %></span></td>
                        <td><%= new Date(user.createdAt).toLocaleDateString() %></td>
                        <td>
                          <div class="btn-group btn-group-sm">
                            <a href="/admin/users/<%= user._id %>" class="btn btn-outline-primary">
                              <i class="fas fa-eye"></i>
                            </a>
                            <a href="/admin/users/<%= user._id %>/approve" class="btn btn-outline-success">
                              <i class="fas fa-check"></i>
                            </a>
                            <a href="/admin/users/<%= user._id %>/reject" class="btn btn-outline-danger">
                              <i class="fas fa-times"></i>
                            </a>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            <% } else { %>
              <p>No pending approvals</p>
            <% } %>
          </div>
        </div>
      </div>
      
      <div class="col-md-6 mb-4">
        <div class="card shadow-sm">
          <div class="card-header bg-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Recent Messages</h5>
              <a href="/admin/messages" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
          </div>
          <div class="card-body p-0">
            <% if (recentMessages && recentMessages.length > 0) { %>
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="bg-light">
                    <tr>
                      <th>From</th>
                      <th>Subject</th>
                      <th>Date</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% recentMessages.forEach(message => { %>
                      <tr class="<%= !message.isRead ? 'table-light fw-bold' : '' %>">
                        <td><%= message.name %></td>
                        <td><a href="/admin/messages/<%= message._id %>" class="text-decoration-none"><%= message.subject %></a></td>
                        <td><%= new Date(message.createdAt).toLocaleDateString() %></td>
                        <td>
                          <% if (message.isRead) { %>
                            <span class="badge bg-secondary">Read</span>
                          <% } else { %>
                            <span class="badge bg-primary">Unread</span>
                          <% } %>
                        </td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            <% } else { %>
              <p>No recent messages</p>
            <% } %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-12 mb-4">
        <div class="card shadow-sm">
          <div class="card-header bg-white">
            <h5 class="mb-0">Quick Actions</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <% if (currentUser.role === 'admin'||currentUser.role === 'co-admin') { %>
                <div class="col-md-3 mb-3">
                  <a href="/pets/new" class="btn btn-outline-primary w-100 py-3">
                    <i class="fas fa-plus-circle mb-2 d-block fa-2x"></i>
                    Add New Pet
                  </a>
                </div>
                <div class="col-md-3 mb-3">
                  <a href="/products/new" class="btn btn-outline-success w-100 py-3">
                    <i class="fas fa-plus-circle mb-2 d-block fa-2x"></i>
                    Add New Product
                  </a>
                </div>
              <% } %>
              <% if (currentUser.role === 'admin') { %>
                <div class="col-md-3 mb-3">
                  <button type="button" class="btn btn-outline-info w-100 py-3" data-bs-toggle="modal" data-bs-target="#addCoAdminModal">
                    <i class="fas fa-user-plus mb-2 d-block fa-2x"></i>
                    Add Co-Admin
                  </button>
                </div>
              <% } %>
              <div class="col-md-3 mb-3">
                <a href="/admin/messages" class="btn btn-outline-warning w-100 py-3">
                  <i class="fas fa-envelope mb-2 d-block fa-2x"></i>
                  Check Messages
                  <% if (unreadCount && unreadCount > 0) { %>
                    <span class="badge bg-danger rounded-pill"><%= unreadCount %></span>
                  <% } %>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <% if (currentUser.role === 'admin') { %>
        <div class="col-md-6 col-lg-4 mb-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">
                <i class="fas fa-user-shield text-primary me-2"></i>Co-Admin Management
              </h5>
              <p class="card-text">Manage co-administrators who can help you run the platform.</p>
            </div>
            <div class="card-footer bg-transparent border-0">
              <a href="/admin/co-admins" class="btn btn-sm btn-outline-primary">
                <i class="fas fa-cog me-1"></i>Manage Co-Admins
              </a>
            </div>
          </div>
        </div>
      <% } %>
    </div>
  </div>
  
  <% if (currentUser.role === 'admin') { %>
  <div class="modal fade" id="addCoAdminModal" tabindex="-1" aria-labelledby="addCoAdminModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addCoAdminModalLabel">Add New Co-Admin</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form action="/admin/co-admins" method="POST">
          <div class="modal-body">
            <div class="mb-3">
              <label for="name" class="form-label">Full Name</label>
              <input type="text" class="form-control" id="name" name="name" required>
            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Email</label>
              <input type="email" class="form-control" id="email" name="email" required>
            </div>
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <input type="password" class="form-control" id="password" name="password" required>
              <small class="text-muted">Password must be at least 6 characters</small>
            </div>
            <div class="mb-3">
              <label for="phone" class="form-label">Phone (Optional)</label>
              <input type="tel" class="form-control" id="phone" name="phone">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Create Co-Admin</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-md-6 col-lg-4 mb-4">
    <div class="card h-100">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Statistics & Analytics</h5>
      </div>
      <div class="card-body">
        <p>View detailed statistics and analytics about users, pets, products, and applications.</p>
        <div class="d-grid">
          <a href="/admin/statistics" class="btn btn-primary">View Statistics</a>
        </div>
      </div>
    </div>
  </div>
  <% } %>
  
  <%- include('../../partials/admin-footer') %>
<% } else if (currentUser.role === 'customer') { %>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <div class="container py-5">
    <div class="row mb-4">
      <div class="col-md-8">
        <h1>My Dashboard</h1>
        <p class="lead">Welcome back, <%= currentUser.name %>!</p>
      </div>
      <div class="col-md-4 text-end">
        <a href="/auth/profile" class="btn btn-outline-primary">
          <i class="fas fa-user-cog me-2"></i>Edit Profile
        </a>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="fas fa-heart me-2"></i>My Applications</h5>
          </div>
          <div class="card-body">
            <% if (applications && applications.length > 0) { %>
              <div class="list-group">
                <% applications.forEach(application => { %>
                  <a href="/dashboard/applications/<%= application._id %>" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between">
                      <h6 class="mb-1"><%= application.pet ? application.pet.name : 'Unknown Pet' %></h6>
                      <small>
                        <% if (application.status === 'submitted') { %>
                          <span class="badge bg-primary">Submitted</span>
                        <% } else if (application.status === 'under review') { %>
                          <span class="badge bg-warning text-dark">Under Review</span>
                        <% } else if (application.status === 'approved') { %>
                          <span class="badge bg-success">Approved</span>
                        <% } else if (application.status === 'denied') { %>
                          <span class="badge bg-danger">Denied</span>
                        <% } %>
                      </small>
                    </div>
                    <small class="text-muted">Submitted on <%= new Date(application.createdAt).toLocaleDateString() %></small>
                  </a>
                <% }); %>
              </div>
            <% } else { %>
              <div class="text-center py-4">
                <i class="fas fa-file-alt fa-3x mb-3 text-muted"></i>
                <p>You haven't submitted any adoption applications yet.</p>
                <a href="/pets" class="btn btn-primary">Browse Pets</a>
              </div>
            <% } %>
          </div>
        </div>
      </div>
      
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-header bg-success text-white">
            <h5 class="mb-0"><i class="fas fa-shopping-bag me-2"></i>My Orders</h5>
          </div>
          <div class="card-body">
            <% if (orders && orders.length > 0) { %>
              <div class="list-group">
                <% orders.forEach(order => { %>
                  <a href="/dashboard/orders/<%= order._id %>" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between">
                      <h6 class="mb-1">Order #<%= order._id.toString().slice(-6).toUpperCase() %></h6>
                      <small>
                        <% if (order.status === 'pending') { %>
                          <span class="badge bg-warning text-dark">Pending</span>
                        <% } else if (order.status === 'processing') { %>
                          <span class="badge bg-info">Processing</span>
                        <% } else if (order.status === 'shipped') { %>
                          <span class="badge bg-primary">Shipped</span>
                        <% } else if (order.status === 'delivered') { %>
                          <span class="badge bg-success">Delivered</span>
                        <% } else if (order.status === 'cancelled') { %>
                          <span class="badge bg-danger">Cancelled</span>
                        <% } %>
                      </small>
                    </div>
                    <small class="text-muted">
                      <%= new Date(order.createdAt).toLocaleDateString() %> • $<%= order.totalAmount ? order.totalAmount.toFixed(2) : 'N/A' %>
                    </small>
                  </a>
                <% }); %>
              </div>
            <% } else { %>
              <div class="text-center py-4">
                <i class="fas fa-shopping-cart fa-3x mb-3 text-muted"></i>
                <p>You haven't placed any orders yet.</p>
                <a href="/products" class="btn btn-success">Shop Products</a>
              </div>
            <% } %>
          </div>
        </div>
      </div>
      
      <div class="col-md-4 mb-4">
        <div class="card h-100">
          <div class="card-header bg-info text-white">
            <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>My Appointments</h5>
          </div>
          <div class="card-body">
            <% if (appointments && appointments.length > 0) { %>
              <div class="list-group">
                <% appointments.forEach(appointment => { %>
                  <a href="/dashboard/appointments/<%= appointment._id %>" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between">
                      <h6 class="mb-1">
                        <% if (appointment.veterinary) { %>
                          Dr. <%= appointment.veterinary.name %>
                        <% } else { %>
                          Unknown Vet
                        <% } %>
                      </h6>
                      <small>
                        <% if (appointment.status === 'scheduled') { %>
                          <span class="badge bg-primary">Scheduled</span>
                        <% } else if (appointment.status === 'completed') { %>
                          <span class="badge bg-success">Completed</span>
                        <% } else if (appointment.status === 'cancelled') { %>
                          <span class="badge bg-danger">Cancelled</span>
                        <% } %>
                      </small>
                    </div>
                    <small class="text-muted">
                      <%= new Date(appointment.date).toLocaleDateString() %> at <%= appointment.time %>
                    </small>
                  </a>
                <% }); %>
              </div>
            <% } else { %>
              <div class="text-center py-4">
                <i class="fas fa-stethoscope fa-3x mb-3 text-muted"></i>
                <p>You don't have any upcoming appointments.</p>
                <a href="/appointments/book" class="btn btn-info">Book Appointment</a>
              </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-8 mb-4">
        <!-- <div class="card">
          <div class="card-header bg-light">
            <h5 class="mb-0">Favorite Pets</h5>
          </div>
          <div class="card-body">
            <% if (favorites && favorites.length > 0) { %>
              <div class="row">
                <% favorites.forEach(pet => { %>
                  <div class="col-md-4 mb-3">
                    <div class="card h-100">
                      <img src="<%= pet.mainImage || '/images/pet-placeholder.jpg' %>" class="card-img-top" alt="<%= pet.name %>" style="height: 150px; object-fit: cover;">
                      <div class="card-body">
                        <h6 class="card-title"><%= pet.name %></h6>
                        <p class="card-text small">
                          <span class="text-capitalize"><%= pet.breed || pet.species %></span> • 
                          <%= pet.age.value %> <%= pet.age.unit %>
                        </p>
                        <a href="/pets/<%= pet._id %>" class="btn btn-sm btn-outline-primary">View Details</a>
                      </div>
                    </div>
                  </div>
                <% }); %>
              </div>
            <% } else { %>
              <div class="text-center py-4">
                <i class="fas fa-heart fa-3x mb-3 text-muted"></i>
                <p>You haven't favorited any pets yet.</p>
                <a href="/pets" class="btn btn-primary">Browse Pets</a>
              </div>
            <% } %>
          </div> -->
        </div>
      </div>
      
      <div class="col-md-4 mb-4">
        <div class="card">
          <div class="card-header bg-light">
            <h5 class="mb-0">Quick Links</h5>
          </div>
          <div class="card-body">
            <div class="list-group">
              <a href="/pets" class="list-group-item list-group-item-action">
                <i class="fas fa-paw me-2"></i>Browse Pets
              </a>
              <a href="/products" class="list-group-item list-group-item-action">
                <i class="fas fa-shopping-basket me-2"></i>Shop Products
              </a>
              <a href="/cart" class="list-group-item list-group-item-action">
                <i class="fas fa-shopping-cart me-2"></i>View Cart
              </a>
              <a href="/appointments/book" class="list-group-item list-group-item-action">
                <i class="fas fa-calendar-plus me-2"></i>Book Appointment
              </a>
              <a href="/contact" class="list-group-item list-group-item-action">
                <i class="fas fa-envelope me-2"></i>Contact Us
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <%- include('../../partials/footer') %>
<% } else if (currentUser.role === 'seller') { %>
  <!-- <%- include('../../partials/navbar') %> -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <div class="container py-5">
    <div class="row mb-4">
      <div class="col-md-8">
        <h1>Seller Dashboard</h1>
        <p class="lead">Welcome back, <%= currentUser.name %>!</p>
        <% if (!currentUser.isApproved) { %>
          <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            Your seller account is pending approval. You'll be able to add products once approved.
          </div>
        <% } %>
      </div>
      <div class="col-md-4 text-end">
        <a href="/auth/profile" class="btn btn-outline-primary">
          <i class="fas fa-user-cog me-2"></i>Edit Profile
        </a>
        <% if (currentUser.isApproved) { %>
          <a href="/products/new" class="btn btn-primary ms-2">
            <i class="fas fa-plus me-2"></i>Add Product
          </a>
        <% } %>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-8 mb-4">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="fas fa-box me-2"></i>My Products</h5>
          </div>
          <div class="card-body p-0">
            <% if (products && products.length > 0) { %>
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="bg-light">
                    <tr>
                      <th style="width: 80px;">Image</th>
                      <th>Name</th>
                      <th>Price</th>
                      <th>Stock</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% products.forEach(product => { %>
                      <tr>
                        <td>
                          <img src="<%= product.mainImage || '/images/product-placeholder.jpg' %>" alt="<%= product.name %>" class="img-thumbnail" style="width: 60px; height: 60px; object-fit: cover;">
                        </td>
                        <td><a href="/products/<%= product._id %>" class="text-decoration-none"><%= product.name %></a></td>
                        <td>
                          <% if (product.onSale) { %>
                            <span class="text-decoration-line-through">$<%= product.price.toFixed(2) %></span>
                            <span class="text-danger">$<%= product.salePrice.toFixed(2) %></span>
                          <% } else { %>
                            $<%= product.price.toFixed(2) %>
                          <% } %>
                        </td>
                        <td>
                          <% if (product.stock <= 0) { %>
                            <span class="badge bg-danger">Out of Stock</span>
                          <% } else if (product.stock < 10) { %>
                            <span class="badge bg-warning text-dark">Low: <%= product.stock %></span>
                          <% } else { %>
                            <%= product.stock %>
                          <% } %>
                        </td>
                        <td>
                          <% if (product.featured) { %>
                            <span class="badge bg-success">Featured</span>
                          <% } %>
                        </td>
                        <td>
                          <div class="btn-group btn-group-sm">
                            <a href="/products/<%= product._id %>" class="btn btn-outline-primary">
                              <i class="fas fa-eye"></i>
                            </a>
                            <a href="/products/<%= product._id %>/edit" class="btn btn-outline-secondary">
                              <i class="fas fa-edit"></i>
                            </a>
                            <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteProductModal<%= product._id %>">
                              <i class="fas fa-trash-alt"></i>
                            </button>
                          </div>
                          
                          <div class="modal fade" id="deleteProductModal<%= product._id %>" tabindex="-1" aria-labelledby="deleteProductModalLabel<%= product._id %>" aria-hidden="true">
                            <div class="modal-dialog">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="deleteProductModalLabel<%= product._id %>">Confirm Delete</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                  Are you sure you want to delete <strong><%= product.name %></strong>? This action cannot be undone.
                                </div>
                                <div class="modal-footer">
                                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                  <form action="/products/<%= product._id %>?_method=DELETE" method="POST">
                                    <button type="submit" class="btn btn-danger">Delete</button>
                                  </form>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            <% } else { %>
              <div class="text-center py-5">
                <i class="fas fa-box-open fa-3x mb-3 text-muted"></i>
                <p>You haven't added any products yet.</p>
                <% if (currentUser.isApproved) { %>
                  <a href="/products/new" class="btn btn-primary">Add Your First Product</a>
                <% } else { %>
                  <p class="text-muted">You'll be able to add products once your account is approved.</p>
                <% } %>
              </div>
            <% } %>
          </div>
        </div>
      </div>
      
      <div class="col-md-4 mb-4">
        <div class="card mb-4">
          <div class="card-header bg-success text-white">
            <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Sales Overview</h5>
          </div>
          <div class="card-body">
            <div class="row text-center">
              <div class="col-6 mb-3">
                <h6 class="text-muted">Total Sales</h6>
                <h3>$<%= totalSales ? totalSales.toFixed(2) : '0.00' %></h3>
              </div>
              <div class="col-6 mb-3">
                <h6 class="text-muted">Orders</h6>
                <h3><%= orders ? orders.length : 0 %></h3>
              </div>
              <div class="col-6">
                <h6 class="text-muted">Products</h6>
                <h3><%= products ? products.length : 0 %></h3>
              </div>
              <div class="col-6">
                <h6 class="text-muted">Avg. Rating</h6>
                <h3><%= averageRating ? averageRating.toFixed(1) : '0.0' %></h3>
              </div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header bg-info text-white">
            <h5 class="mb-0"><i class="fas fa-bell me-2"></i>Recent Orders</h5>
          </div>
          <div class="card-body p-0">
            <% if (orders && orders.length > 0) { %>
              <div class="list-group list-group-flush">
                <% orders.slice(0, 5).forEach(order => { %>
                  <a href="/orders/<%= order._id %>" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between">
                      <h6 class="mb-1">Order #<%= order._id.toString().slice(-6).toUpperCase() %></h6>
                      <small>
                        <% if (order.status === 'pending') { %>
                          <span class="badge bg-warning text-dark">Pending</span>
                        <% } else if (order.status === 'processing') { %>
                          <span class="badge bg-info">Processing</span>
                        <% } else if (order.status === 'shipped') { %>
                          <span class="badge bg-primary">Shipped</span>
                        <% } else if (order.status === 'delivered') { %>
                          <span class="badge bg-success">Delivered</span>
                        <% } else if (order.status === 'cancelled') { %>
                          <span class="badge bg-danger">Cancelled</span>
                        <% } %>
                      </small>
                    </div>
                    <small class="text-muted">
                      <%= new Date(order.createdAt).toLocaleDateString() %> • $<%= order.totalAmount ? order.totalAmount.toFixed(2) : 'N/A' %>
                    </small>
                  </a>
                <% }); %>
              </div>
              <% if (orders.length > 5) { %>
                <div class="card-footer text-center">
                  <a href="/orders/seller" class="text-decoration-none">View All Orders</a>
                </div>
              <% } %>
            <% } else { %>
              <div class="text-center py-4">
                <i class="fas fa-shopping-bag fa-3x mb-3 text-muted"></i>
                <p>No orders yet.</p>
              </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- <%- include('../../partials/footer') %> -->
<% } else if (currentUser.role === 'veterinary') { %>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <div class="container py-5">
    <div class="row mb-4">
      <div class="col-md-8">
        <h1>Veterinary Dashboard</h1>
        <p class="lead">Welcome back, Dr. <%= currentUser.name %>!</p>
        <% if (!currentUser.isApproved) { %>
          <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            Your veterinary account is pending approval. You'll be able to manage appointments once approved.
          </div>
        <% } %>
      </div>
      <div class="col-md-4 text-end">
        <a href="/auth/profile" class="btn btn-outline-primary">
          <i class="fas fa-user-cog me-2"></i>Edit Profile
        </a>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-8 mb-4">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Upcoming Appointments</h5>
          </div>
          <div class="card-body p-0">
            <% if (appointments && appointments.length > 0) { %>
              <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                  <thead class="bg-light">
                    <tr>
                      <th>Date & Time</th>
                      <th>Pet Owner</th>
                      <th>Pet</th>
                      <th>Reason</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% appointments.forEach(appointment => { %>
                      <tr>
                        <td>
                          <%= new Date(appointment.date).toLocaleDateString() %><br>
                          <small class="text-muted"><%= appointment.time %></small>
                        </td>
                        <td>
                          <% if (appointment.customer) { %>
                            <%= appointment.customer.name %>
                          <% } else { %>
                            Unknown
                          <% } %>
                        </td>
                        <td>
                          <% if (appointment.petName) { %>
                            <%= appointment.petName %>
                          <% } else { %>
                            Not specified
                          <% } %>
                        </td>
                        <td><%= appointment.reason %></td>
                        <td>
                          <% if (appointment.status === 'scheduled') { %>
                            <span class="badge bg-primary">Scheduled</span>
                          <% } else if (appointment.status === 'completed') { %>
                            <span class="badge bg-success">Completed</span>
                          <% } else if (appointment.status === 'cancelled') { %>
                            <span class="badge bg-danger">Cancelled</span>
                          <% } %>
                        </td>
                        <td>
                          <div class="btn-group btn-group-sm">
                            <a href="/dashboard/appointments/<%= appointment._id %>" class="btn btn-outline-primary">
                              <i class="fas fa-eye"></i>
                            </a>
                            <% if (appointment.status === 'scheduled') { %>
                              <a href="/dashboard/appointments/<%= appointment._id %>/complete" class="btn btn-outline-success">
                                <i class="fas fa-check"></i>
                              </a>
                              <a href="/dashboard/appointments/<%= appointment._id %>/cancel" class="btn btn-outline-danger">
                                <i class="fas fa-times"></i>
                              </a>
                            <% } %>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            <% } else { %>
              <div class="text-center py-5">
                <i class="fas fa-calendar-day fa-3x mb-3 text-muted"></i>
                <p>No upcoming appointments.</p>
              </div>
            <% } %>
          </div>
        </div>
      </div>
      
      <div class="col-md-4 mb-4">
        <div class="card mb-4">
          <div class="card-header bg-info text-white">
            <h5 class greetings="mb-0"><i class="fas fa-user-md me-2"></i>Your Schedule</h5>
          </div>
          <div class="card-body">
            <% if (currentUser.vetInfo && currentUser.vetInfo.availableDays && currentUser.vetInfo.availableDays.length > 0) { %>
              <h6 class="mb-3">Available Days:</h6>
              <div class="mb-3">
                <% currentUser.vetInfo.availableDays.forEach(day => { %>
                  <span class="badge bg-primary me-1 mb-1"><%= day %></span>
                <% }); %>
              </div>
              
              <h6 class="mb-2">Hours:</h6>
              <p>
                <% if (currentUser.vetInfo.availableHours && currentUser.vetInfo.availableHours.start && currentUser.vetInfo.availableHours.end) { %>
                  <%= currentUser.vetInfo.availableHours.start %> - <%= currentUser.vetInfo.availableHours.end %>
                <% } else { %>
                  Not specified
                <% } %>
              </p>
            <% } else { %>
              <div class="alert alert-warning mb-0">
                <i class="fas fa-exclamation-circle me-2"></i>
                You haven't set your availability yet. Please update your profile to specify your available days and hours.
              </div>
            <% } %>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header bg-success text-white">
            <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Statistics</h5>
          </div>
          <div class="card-body">
            <div class="row text-center">
              <div class="col-6 mb-3">
                <h6 class="text-muted">Total Appointments</h6>
                <h3><%= totalAppointments || 0 %></h3>
              </div>
              <div class="col-6 mb-3">
                <h6 class="text-muted">Completed</h6>
                <h3><%= completedAppointments || 0 %></h3>
              </div>
              <div class="col-6">
                <h6 class="text-muted">Upcoming</h6>
                <h3><%= upcomingAppointments || 0 %></h3>
              </div>
              <div class="col-6">
                <h6 class="text-muted">Cancelled</h6>
                <h3><%= cancelledAppointments || 0 %></h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <%- include('../../partials/footer') %>
<% } %>